<!-- Tree/Grid/Grid.html -->

<!-- Tree/Grid/Grid.html -->

<li><a href="#" onclick="window.parent.handleLinkClick(event, 'receiver.html')">Grid Branch 77</a></li>
<li><a href="#" onclick="window.document.handleLinkClick01(event, 'Tree/Grid/GridBranch01.html')">Grid Branch 78</a></li>
<a href="Tree/Grid/GridBranch01.html" target="_blank">打开嵌入页面</a>

  <table id="myTable">
    <thead>
      <tr>
        <!-- 欄位標題 -->
      </tr>
    </thead>
    <tbody>
      <!-- 資料行將以動態方式插入此處 -->
    </tbody>
  </table>



  <script>
    console.log("自己");
    // 监听来自父窗口的消息
    window.addEventListener('message', function(event) {
      // 获取父窗口发送的消息
      var message = event.data;
  
      if (message === 'fetchData') {
        // 调用获取数据的函数
        fetchData();
      }
    });
  
    function fetchData() {
    console.log("Hello script02app自己");
    fetch('http://localhost:8081/data')
      .then(function(response) {
        return response.json();
      })
      .then(function(data) {
        var table = document.getElementById('');
        var tableHeader = table.getElementsByTagName('thead')[0].getElementsByTagName('tr')[0];
        var tableBody = table.getElementsByTagName('tbody')[0];
  
        // 动态生成欄位標題
        for (var key in data.recordset[0]) {
          var th = document.createElement('th');
          th.textContent = key;
          tableHeader.appendChild(th);
        }
  
        // 动态生成資料行
        for (var i = 0; i < data.recordset.length; i++) {
          var rowData = data.recordset[i];
          var newRow = tableBody.insertRow(i);
  
          for (var key in rowData) {
            var cell = newRow.insertCell();
            cell.textContent = rowData[key];
          }
        }
      })
      .catch(function(error) {
        console.log('Error:', error);
      });
  }
  </script>
  


<script>
  console.log("Hello");
// function handleLinkClick(event, linkUrl) {
//   console.log("Hello script-2");
//   event.preventDefault(); // 阻止默认的链接跳转行为
//   console.log("Hello script-3");
//   // 使用 postMessage 向父文档发送消息
//   window.parent.postMessage({ linkUrl }, '*');
//   console.log("Hello script-4");
// }


function handleLinkClick01(event, linkUrl) {
  console.log("Hello");
  event.preventDefault(); // 阻止默认的链接跳转行为

  var contentElement = parent.document.getElementById('gridContentContainer'); // 获取右侧分割畫面的容器元素

  // 使用 AJAX 加载链接的内容
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 && xhr.status === 200) {
      // 将新内容赋值给 contentElement 的 innerHTML
      contentElement.innerHTML = xhr.responseText;
      
      // 调用获取数据的函数
      fetchData();
    }
  };

  xhr.open('GET', linkUrl, true);
  xhr.send();
}

// 获取数据的函数
function fetchData() {
  console.log("Hello script02自己");
  fetch('http://localhost:8081/data')
    .then(function(response) {
      return response.json();
    })
    .then(function(data) {
      var table = document.getElementById('');
      var tableHeader = table.getElementsByTagName('thead')[0].getElementsByTagName('tr')[0];
      var tableBody = table.getElementsByTagName('tbody')[0];

      // 动态生成欄位標題
      for (var key in data.recordset[0]) {
        var th = document.createElement('th');
        th.textContent = key;
        tableHeader.appendChild(th);
      }

      // 动态生成資料行
      for (var i = 0; i < data.recordset.length; i++) {
        var rowData = data.recordset[i];
        var newRow = tableBody.insertRow(i);

        for (var key in rowData) {
          var cell = newRow.insertCell();
          cell.textContent = rowData[key];
        }
      }
    })
    .catch(function(error) {
      console.log('Error:', error);
    });
}













console.log("Hello script");
    // 從後端獲取資料
    fetch('http://localhost:8081/data')
      .then(function(response) {
        console.log("Hello script02");
        return response.json();
      })
      .then(function(data) {
        var table = document.getElementById('myTable');
        var tableHeader = table.getElementsByTagName('thead')[0].getElementsByTagName('tr')[0];
        var tableBody = table.getElementsByTagName('tbody')[0];

        // 動態生成欄位標題
        for (var key in data.recordset[0]) {
          var th = document.createElement('th');
          th.textContent = key;
          tableHeader.appendChild(th);
        }

        // 動態生成資料行
        for (var i = 0; i < data.recordset.length; i++) {
          var rowData = data.recordset[i];
          var newRow = tableBody.insertRow(i);

          for (var key in rowData) {
            var cell = newRow.insertCell();
            cell.textContent = rowData[key];
          }
        }
      })
      .catch(function(error) {
        console.log('Error:', error);
      });
</script>
