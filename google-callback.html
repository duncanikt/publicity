<!-- google-callback.html -->

<!DOCTYPE html>
<html>
<head>
  <title>Google Callback</title>
</head>
<body>
  <script>
    // 获取 URL 参数中的授权码
    const urlParams = new URLSearchParams(window.location.search);
    const authorizationCode = urlParams.get('code');
    console.log('Author 授權碼:', authorizationCode);

    // 将授权码发送给后端
    fetch('https://i75birth.ddns.net/auth/google/callback', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ code: authorizationCode }),
    })
    .then(response => response.json())
    .then(data => {
      console.log('后端返回的数据:', data);
        // 将令牌存储在 localStorage 中
        // localStorage.setItem('jwt', data.token); //跟下面一行兩種寫法都可以
        const token = data.token;
        const expirationTime = data.expirationTime; // 从后端响应中获取到期时间
        sessionStorage.setItem('jwt', token);
        localStorage.setItem('jwt', token);
        localStorage.setItem('expirationTime', expirationTime); // 保存到期时间 
        // 跳转到 index02.html 页面
        window.location.href = 'https://duncanikt.github.io/exhibit/index02.html';
    })
    .catch(error => {
      console.error('发生错误:', error);
    });
  </script>
</body>
</html>




