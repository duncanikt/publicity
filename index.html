<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
  integrity="29f0768507f33e4ca7708ae24a0bb60105f9b4f3d897ac12a4aa72bcc82bd5941aa2e327f2be32cea30a181a676fec9a"
  crossorigin="anonymous"
/>





  <title>ç™»å…¥/è¨»å†Š</title>
  <style>


.google-login-text {
  font-size: 1.5em; /* è°ƒæ•´æ–‡æœ¬å¤§å° */
  vertical-align: middle; /* å‚ç›´å±…ä¸­æ–‡æœ¬ */
  margin-left: 0px; /* è°ƒæ•´æ–‡æœ¬ä¸å›¾æ ‡ä¹‹é—´çš„é—´è· */
}



#google-login-button i.fa-google {
  background: conic-gradient(from -45deg, #ea4335 110deg, #4285f4 90deg 180deg, #34a853 180deg 270deg, #fbbc05 270deg) 73% 55%/150% 150% no-repeat;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  -webkit-text-fill-color: transparent;
  vertical-align: middle; /* è°ƒæ•´å›¾æ ‡å‚ç›´å±…ä¸­ */
  margin-bottom: -2px; /* è°ƒæ•´å›¾æ ‡ä½ç½®å¾€ä¸‹ä¸€ç‚¹ */
}

#togglePassword {
  border: none;
  background: none;
  cursor: pointer;
  font-size: 16px;
  margin-left: -30px;
}


#google-login-button {
  display: inline-block;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 10px 20px;
  font-size: 14px;
  color: #333;
  cursor: pointer;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
  transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
  width: 263px;
}

#google-login-button i.fa-google {
  margin-right: 10px; /* è°ƒæ•´å›¾æ ‡å’Œæ–‡æœ¬ä¹‹é—´çš„é—´è· */
}


#google-login-button:hover {
  background-color: #f5f5f5;
  border-color: #aaa;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
}












    .recaptcha-container {
      display: inline-block;
      transform: scale(0.88); /* è¨­å®šå¤–éƒ¨å®¹å™¨çš„ç¸®æ”¾æ¯”ä¾‹ï¼Œæ ¹æ“šéœ€è¦èª¿æ•´ */
      transform-origin: 0 0; /* è¨­å®šç¸®æ”¾çš„åŸºæº–é»ï¼Œå·¦ä¸Šè§’ç‚ºåŸé» */
    }

    .registerBody {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0px 0px 0px 170px;
    }



    form {
      margin-top: 20px;
      display: inline-block;
      text-align: left;
    }

    label {
      display: block;
      margin-bottom: 8px;
    }

    input {
      width: 250px;
      padding: 5px;
      margin-bottom: 10px;
    }

    #loginRegister.g-recaptcha {
      /* display: inline-block; */
       /* è¨­ç½®æŒ‰éˆ•é–“è·ï¼Œæ ¹æ“šéœ€è¦è‡ªç”±èª¿æ•´ */
      margin-right: 23px;
      /* padding: 8px 15px; */
      background-color: green;
      color: white;
      border: none;
      cursor: pointer;
      width:  60px;
      height: 30px;
    }
    #loginRegister02.g-recaptcha {
      /* display: inline-block; */
       /* è¨­ç½®æŒ‰éˆ•é–“è·ï¼Œæ ¹æ“šéœ€è¦è‡ªç”±èª¿æ•´ */
      margin-right: 23px;
      /* padding: 8px 15px; */
      background-color: green;
      color: white;
      border: none;
      cursor: pointer;
      width:  60px;
      height: 30px;
    }
    .button-container {
      display: flex;
      justify-content: space-around;
      margin: 0px 0px 0px 0px; /* è¨­ç½®å®¹å™¨ä¸Šæ–¹é–“è· */
    }


  </style>
</head>
<body>
  <div class="registerBody">

    <h1 style="display:inline-block; margin: 30px 0px 0px 0px;">ç™»å…¥05</h1><h6 style="display:inline-block; margin: 0px 0px 0px 0px;">(é è¨­å¸³å¯†guestï¼Œå¯è‡ªè¡Œè¨»å†Šã€‚)</h6>
    <br>
  <form id="registerForm" style="margin: 50px 0px 0px 30px;">
    <label for="username">ä½¿ç”¨è€…åç¨±ï¼š</label>
    <input type="text" id="username" required>

    <label for="password">å¯†ç¢¼ï¼š</label>
    <input type="password" id="password" required>
    <button id="togglePassword" type="button">ğŸ‘ï¸</button>
    
    <br>
    <div class="recaptcha-container">
      <div
        class="g-recaptcha"
        data-sitekey="6LdsYVEnAAAAADxRZ3lwmjihG2xIMwlU7K2P71Zf"
        data-theme="light"
        data-size="normal"
        data-callback="verifyCallback02"
        data-expired-callback="expired"
        data-error-callback="error"
      ></div>
    </div>
  

    <div class="button-container">
    <button
    id="loginRegister"
    class="g-recaptcha"
    data-sitekey="6Ldq_FAnAAAAAGZvTnh8nCtUwyDqMt6IsQYecHxh"
    data-action="submit01"
    data-callback="verifyCallback"
    type="button">
    ç™»å…¥
  </button>

  <span style="padding-left:120px;"></span>
    <button
    id="loginRegister02"
    class="g-recaptcha"
    data-sitekey="6Ldq_FAnAAAAAGZvTnh8nCtUwyDqMt6IsQYecHxh"
    data-action="submit02"
    data-callback="verifyCallback"
    type="button">
    è¨»å†Š
  </button>

  <h6 id="h6nono" style="display: inline-block;margin: 8px 0px 0px -15px;">(è¨»å†Šæ–¹å¼:ä¸Šæ–¹è¼¸å…¥å¸³å¯†é»æ“Šè¨»å†Šã€‚)</h6>  
</div>
<br><br>
<button
  id="google-login-button"
  class="g-recaptcha"
  data-sitekey="6Ldq_FAnAAAAAGZvTnh8nCtUwyDqMt6IsQYecHxh"
  data-action="submit03"
  data-callback="verifyCallback03"
  type="button">
  <i class="fab fa-google fa-2x"></i><span class="google-login-text">Google å¸³è™Ÿç™»å…¥</span>
</button>




<br>
<h3 id="statusMessage"></h3>
    <!-- <button type="button" onclick="submitForm()">è¨»å†Š</button> -->
  </form>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  <script src="https://www.google.com/recaptcha/api.js?render=6Ldq_FAnAAAAAGZvTnh8nCtUwyDqMt6IsQYecHxh"></script>
  <script>

    function handleGoogleLogin() {
      // è·³è½¬åˆ°åç«¯çš„ç™»å½•è·¯ç”±ï¼Œå³ https://i75birth.ddns.net/auth/google
      window.location.href = 'https://i75birth.ddns.net/auth/google/callback';
    }
    // Function to submit the form and handle backend validation
    //  function submitForm() {
    //   alert('å‰å¾Œç«¯ä¼ºæœå™¨V3 Google reCAPTCHAé©—è­‰æˆåŠŸï¼');
    //   window.location.href = 'index02.html';
    // }

    let verifyResult; //åˆ¤æ–·ä½¿ç”¨è€…æ˜¯å¦å·²ç¶“é©—è­‰äº†ã€‚
    let buttonType; //åˆ¤æ–·æ˜¯é»é¸ç™»å…¥é‚„æ˜¯è¨»å†Šã€‚
    // ç›£è½ç™»éŒ„æŒ‰éˆ•é»æ“Šäº‹ä»¶
    document.querySelector('.g-recaptcha[data-action="submit01"]').addEventListener('click', function () {
  console.log('ç›£è½login');
      // buttonType = 'login'; //æ–¹ä¾¿æ¸¬è©¦ä»¥å¾Œè¨˜å¾—åˆªã€‚
    // å…ˆæª¢æŸ¥ result.success æ˜¯å¦ç‚º trueï¼Œå¦‚æœæ˜¯æ‰åŸ·è¡Œç™»éŒ„æŒ‰éˆ•çš„è™•ç†
    if (verifyResult && verifyResult.success) {
      buttonType = 'login';
    } else {
      alert('è«‹å…ˆå‹¾é¸â€œæˆ‘ä¸æ˜¯æ©Ÿå™¨äººâ€ã€‚');
      // console.log('è¨˜å¾—æŠŠè«‹å…ˆé€šéé©—è­‰ã€‚è§£é™¤è¨»è§£');
    }
});

    // ç›£è½googleç™»éŒ„æŒ‰éˆ•é»æ“Šäº‹ä»¶
    document.querySelector('.g-recaptcha[data-action="submit03"]').addEventListener('click', function () {
  console.log('ç›£è½google login');
      buttonType = 'login'; //æ–¹ä¾¿æ¸¬è©¦ä»¥å¾Œè¨˜å¾—åˆªã€‚
    // å…ˆæª¢æŸ¥ result.success æ˜¯å¦ç‚º trueï¼Œå¦‚æœæ˜¯æ‰åŸ·è¡Œç™»éŒ„æŒ‰éˆ•çš„è™•ç†
    if (verifyResult && verifyResult.success) {
      buttonType = 'login';
    } else {
      // alert('è«‹å…ˆé€šéé©—è­‰ã€‚');
      console.log('è¨˜å¾—æŠŠè«‹å…ˆé€šéé©—è­‰ã€‚è§£é™¤è¨»è§£');
    }


});


// ç›£è½è¨»å†ŠæŒ‰éˆ•é»æ“Šäº‹ä»¶
document.querySelector('.g-recaptcha[data-action="submit02"]').addEventListener('click', function () {
  console.log('ç›£è½register');
  // å…ˆæª¢æŸ¥ result.success æ˜¯å¦ç‚º trueï¼Œå¦‚æœæ˜¯æ‰åŸ·è¡Œç™»éŒ„æŒ‰éˆ•çš„è™•ç†
  if (verifyResult && verifyResult.success) {
    buttonType = 'register';
  } else {
    alert('è«‹å…ˆå‹¾é¸â€œæˆ‘ä¸æ˜¯æ©Ÿå™¨äººâ€ã€‚');
  }
});




// ç›£è½è¡¨å–®çš„ keydown äº‹ä»¶
document.getElementById('registerForm').addEventListener('keydown', function (event) {
  // å¦‚æœæŒ‰ä¸‹çš„æ˜¯ Enter éµ (keyCode 13)
  if (event.keyCode === 13) {
    // é˜»æ­¢é è¨­çš„ Enter éµè¡Œç‚ºï¼ˆä¾‹å¦‚æ›è¡Œï¼‰
    event.preventDefault();
    // å…ˆæª¢æŸ¥ result.success æ˜¯å¦ç‚º trueï¼Œå¦‚æœæ˜¯æ‰åŸ·è¡Œç™»éŒ„æŒ‰éˆ•çš„è™•ç†
    if (verifyResult && verifyResult.success) {
      buttonType = 'register';
    } else {
      alert('è«‹å…ˆé€šéé©—è­‰ã€‚');
    }
    // æ¨¡æ“¬é»æ“Šç™»éŒ„æŒ‰éˆ•
    document.querySelector('.g-recaptcha[data-action="submit01"]').click();
  }
});



  // ç²å–æŒ‰éˆ•å…ƒç´ 
  const loginButton = document.querySelector('.g-recaptcha[data-action="submit01"]');
  const registerButton = document.querySelector('.g-recaptcha[data-action="submit02"]');
  const GoogleButton = document.querySelector('.g-recaptcha[data-action="submit03"]');

  const h6nono = document.getElementById('h6nono');

  const statusMessage = document.getElementById('statusMessage');

  // æŠŠ token é€åˆ°å¾Œç«¯åšé©—è­‰
  function verifyCallback(token) {
    if (buttonType === 'login' || buttonType === 'register') {
      loginButton.style.visibility = 'hidden';
      registerButton.style.visibility = 'hidden';
      GoogleButton.style.visibility = 'hidden';
      h6nono.style.visibility = 'hidden';
      statusMessage.textContent = 'åŸ·è¡Œä¸­...';
    }
    // å‘é€ POST è¯·æ±‚åˆ°åç«¯è¿›è¡ŒéªŒè¯
    fetch('https://i75birth.ddns.net/submit-form', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      // body: JSON.stringify(formData),
      body: JSON.stringify({ token: token }),
    })





      .then(response => response.json())
      .then(result => {
        if (result.success) {
        // é©—è­‰æˆåŠŸï¼Œæ ¹æ“šæŒ‰éˆ•é¡å‹åŸ·è¡Œä¸åŒçš„ç¨‹å¼ç¢¼
        if (buttonType === 'login') {
          // ç™»éŒ„æŒ‰éˆ•çš„ç¨‹å¼ç¢¼
          // window.location.href = 'https://i75birth.ddns.net/auth/google';
          handleLogin() 
        } else if (buttonType === 'register') {
          console.log('åŸ·è¡Œè¨»å†Šfunction');
          handleLoginOrRegister(token);
        }
      } else {
        // é©—è­‰å¤±æ•—ï¼Œçµ¦å‡ºéŒ¯èª¤æç¤º
        alert('V3 Google reCAPTCHAé©—è­‰å¤±æ•—ã€‚');
        // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
        showButtonsAndRemoveStatus()
      }
      })
      .catch(error => {
        console.error('error V3 å¤±æ•—:', error);
        alert('error V3 Google reCAPTCHAé©—è­‰å•é¡Œ è«‹ç¨å¾Œå†è©¦ã€‚');
        // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
        showButtonsAndRemoveStatus()
      });
  }







  function verifyCallback03(token) {
    if (buttonType === 'login' || buttonType === 'register') {
      loginButton.style.visibility = 'hidden';
      registerButton.style.visibility = 'hidden';
      GoogleButton.style.visibility = 'hidden';
      h6nono.style.visibility = 'hidden';
      statusMessage.textContent = 'åŸ·è¡Œä¸­...';
    }
    // å‘é€ POST è¯·æ±‚åˆ°åç«¯è¿›è¡ŒéªŒè¯
    fetch('https://i75birth.ddns.net/submit-form', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      // body: JSON.stringify(formData),
      body: JSON.stringify({ token: token }),
    })
      .then(response => response.json())
      .then(result => {
        if (result.success) {
        // é©—è­‰æˆåŠŸï¼Œæ ¹æ“šæŒ‰éˆ•é¡å‹åŸ·è¡Œä¸åŒçš„ç¨‹å¼ç¢¼
        if (buttonType === 'login') {
          // ç™»éŒ„æŒ‰éˆ•çš„ç¨‹å¼ç¢¼
          window.location.href = 'https://i75birth.ddns.net/auth/google';
          // handleLogin() 
        } else if (buttonType === 'register') {
          console.log('åŸ·è¡Œè¨»å†Šfunction');
          handleLoginOrRegister(token);
        }
      } else {
        // é©—è­‰å¤±æ•—ï¼Œçµ¦å‡ºéŒ¯èª¤æç¤º
        alert('V3 Google reCAPTCHAé©—è­‰å¤±æ•—ã€‚');
        // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
        showButtonsAndRemoveStatus()
      }
      })
      
      .catch(error => {
        console.error('error V3 å¤±æ•—:', error);
        alert('error V3 Google reCAPTCHAé©—è­‰å•é¡Œ è«‹ç¨å¾Œå†è©¦ã€‚');
        // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
        showButtonsAndRemoveStatus()
      });
  }










    // æŠŠ token é€åˆ°å¾Œç«¯åšé©—è­‰
    function verifyCallback02(token) {
    loginButton.style.visibility = 'hidden';
    registerButton.style.visibility = 'hidden';
    GoogleButton.style.visibility = 'hidden';
    h6nono.style.visibility = 'hidden';
    statusMessage.textContent = 'å¾Œç«¯ä¼ºæœå™¨é©—è­‰ä¸­...';

    // å‘é€ POST è¯·æ±‚åˆ°åç«¯è¿›è¡ŒéªŒè¯
    fetch('https://i75birth.ddns.net/submit-form02', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      // body: JSON.stringify(formData),
      body: JSON.stringify({ token: token }),
    })
      .then(response => response.json())
      .then(result => {
        showButtonsAndRemoveStatus()
        if (result.success) {
          verifyResult = result; // å°‡ result å­˜å„²åœ¨è®Šæ•¸ verifyResult ä¸­
          // éªŒè¯æˆåŠŸï¼Œç»§ç»­å¤„ç†è¡¨å•æäº¤
          // alert('V2 Google reCAPTCHAå¾Œç«¯é©—è­‰ä¹Ÿé€šéã€‚');
                  // åœ¨ä¸€åˆ†é’Ÿåé‡ç½®éªŒè¯ç»“æœå’ŒæŒ‰é’®ç±»å‹
          setTimeout(() => {
            verifyResult = null;
            buttonType = null;
          }, 60000); // 60000 æ¯«ç§’ç­‰äº 1 åˆ†é’Ÿ
        } else {
          // éªŒè¯å¤±è´¥ï¼Œç»™å‡ºé”™è¯¯æç¤º
          alert('V2 Google reCAPTCHAå¤±æ•—ï¼å¾Œç«¯é©—è­‰æ²’éã€‚');
          showButtonsAndRemoveStatus()
        }
      })
      .catch(error => {
        showButtonsAndRemoveStatus()
        console.error('V2è¨»å†Šå¤±æ•—:', error);
        alert('errorï¼ V2 Google reCAPTCHAå¤±æ•—ï¼è«‹ç¨å¾Œå†è©¦ã€‚');
        showButtonsAndRemoveStatus()
      });
  }








    // æ–°å‡½æ•¸ï¼Œè™•ç†å¯†ç¢¼å“ˆå¸Œè™•ç†å’Œå‚³éå¸³å¯†åˆ°å¾Œç«¯çš„ç™»éŒ„è·¯ç”±å’Œè¨»å†Šè·¯ç”±
    function handleLoginOrRegister(token) {

      // åœ¨é€™è£¡è™•ç†å¯†ç¢¼å“ˆå¸Œè™•ç†å’Œå‚³éå¸³å¯†åˆ°å¾Œç«¯çš„ç¨‹å¼ç¢¼
      // å–å¾—ä½¿ç”¨è€…åç¨±å’Œå¯†ç¢¼
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      // åœ¨é€™è£¡æ·»åŠ å¯†ç¢¼å“ˆå¸Œè™•ç†çš„ç¨‹å¼ç¢¼ï¼Œä¾‹å¦‚ä½¿ç”¨ bcrypt æˆ–å…¶ä»–é©åˆçš„æ–¹å¼

      // ç™¼é€ POST è«‹æ±‚åˆ°å¾Œç«¯é€²è¡Œé©—è­‰
      fetch('https://i75birth.ddns.net/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ username: username, password: password, token: token }),
            credentials: 'include', // é‡è¦ï¼šå¯ç”¨è·¨åŸŸè¯·æ±‚ä¸­çš„cookieå‘é€

      })
        .then(response => {
          if (!response.ok) {
            throw response; // æ‹‹å‡º response ç‰©ä»¶ä»¥è§¸ç™¼ .catch() å€å¡Š
          }
          return response.json();
        })
        .then(result => {
          // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
          showButtonsAndRemoveStatus()
          if (result.success) {
            // é©—è­‰æˆåŠŸï¼Œç¹¼çºŒè™•ç†è¡¨å–®æäº¤
            alert('è¨»å†ŠæˆåŠŸã€‚');
          } else {
            alert('éŒ¯èª¤ã€‚');
            showButtonsAndRemoveStatus()
          }
        })
        .catch(error => {
          // æ·»åŠ åŸæœ¬çš„æŒ‰éˆ•æ¨£å¼
          if (error.status === 409) {
            error.json().then(data => {
              alert(data.error); // é¡¯ç¤ºä¼ºæœå™¨å›æ‡‰çš„éŒ¯èª¤è¨Šæ¯
              showButtonsAndRemoveStatus()
            });
          } else {
            console.error('ä¼ºæœå™¨éŒ¯èª¤:', error);
            alert('ä¼ºæœå™¨éŒ¯èª¤ã€‚');
            showButtonsAndRemoveStatus()
          }
        });
}






// ç™»å½•æˆåŠŸåï¼Œä¿å­˜ä»¤ç‰Œåˆ°ä¸€ä¸ªå˜é‡ä¸­
// const token = getJwtToken();


     // æ–°å‡½æ•¸ï¼Œè™•ç†å¯†ç¢¼å“ˆå¸Œè™•ç†å’Œå‚³éå¸³å¯†åˆ°å¾Œç«¯çš„ç™»éŒ„è·¯ç”±å’Œè¨»å†Šè·¯ç”±
     function handleLogin() {
        // å–å¾—ä½¿ç”¨è€…åç¨±å’Œå¯†ç¢¼
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // åœ¨é€™è£¡æ·»åŠ å¯†ç¢¼å“ˆå¸Œè™•ç†çš„ç¨‹å¼ç¢¼ï¼Œä¾‹å¦‚ä½¿ç”¨ bcrypt æˆ–å…¶ä»–é©åˆçš„æ–¹å¼
        console.log('å‰ç«¯ç™»å…¥å‰æ‰“å°cookie',document.cookie);
        // console.log('å“åº”å¤´ä¸­çš„ cookie:', response.headers.get('Set-Cookie'));


        // æ·»åŠ è¶…æ—¶å¤„ç†
        const timeoutPromise = new Promise((resolve, reject) => {
          setTimeout(() => {
            reject('è¯·æ±‚è¶…æ—¶'); // åœ¨æŒ‡å®šæ—¶é—´åè§¦å‘è¶…æ—¶é”™è¯¯
          }, 10000); // è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º 10000 æ¯«ç§’ï¼ˆ10 ç§’ï¼‰
        });





        // ç™¼é€ POST è«‹æ±‚åˆ°å¾Œç«¯é€²è¡Œé©—è­‰
        // fetch('https://i75birth.ddns.net/auth/google', {
          const fetchPromise = fetch('https://i75birth.ddns.net/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',

          },
          body: JSON.stringify({ username: username, password: password }),
          // credentials: 'include', // é‡è¦ï¼šå¯ç”¨è·¨åŸŸè¯·æ±‚ä¸­çš„cookieå‘é€
        })
        Promise.race([fetchPromise, timeoutPromise])

        .then(response => {
          if (response.ok) {
            openWindow();
            showButtonsAndRemoveStatus()
            return response.json();
          }
          if (response.status === 401) {
            showButtonsAndRemoveStatus()
            alert('ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç ã€‚');
            return Promise.reject('401');
          }

        })
          .then(data => {
            console.log('æœ‰æ²’æœ‰åŸ·è¡Œä»¤ç‰Œ');
            // ä»å“åº”ä¸­è·å–ä»¤ç‰Œå¹¶ä¿å­˜åœ¨æœ¬åœ°
            const token = data.token;
            const expirationTime = data.expirationTime; // ä»åç«¯å“åº”ä¸­è·å–åˆ°æœŸæ—¶é—´
            sessionStorage.setItem('jwt', token);
            localStorage.setItem('jwt', token);
            localStorage.setItem('expirationTime', expirationTime); // ä¿å­˜åˆ°æœŸæ—¶é—´  
    
          })

          .catch(error => {
            if (error === 'è¯·æ±‚è¶…æ—¶') {
              showButtonsAndRemoveStatus();
              alert('è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åå†è¯•ã€‚');
            }else
            if (error == 401) {
            } else {
              showButtonsAndRemoveStatus()
              console.error('ç™»å½•å¤±è´¥:', error);
              alert('ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚');
            }
          });
      }






      function fetchDataWithToken(token) {
        const url = 'https://i75birth.ddns.net/data?search=' + encodeURIComponent(searchInput) + '&engName=' + encodeURIComponent(engName) + '&startDate=' + encodeURIComponent(startDate) + '&endDate=' + encodeURIComponent(endDate);
        console.log('url:', url);
        addBT = '';
        fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`
          },
          credentials: 'include',
        })
        .then(response => response.json())
        .then(data => {
          // åœ¨è¿™é‡Œå¤„ç†è¿”å›çš„æ•°æ®
        })
        .catch(error => {
          console.error('è·å–æ•°æ®å¤±è´¥:', error);
          alert('è·å–æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚');
        });
      }













      function openWindow() {
                var w_width = 200;
                var w_height = 100;
                var x = (screen.width - w_width) / 2;
                var y = (screen.height - w_height) / 2;
                var ww = 'width=' + w_width + ',height=' + w_height + ',top=' + y + ',left=' + x;
                var openWIN = window.open('', '', ww);
                openWIN.document.write('<h2 style="text-align: center;">ç™»å…¥æˆåŠŸ</h2>');
                setTimeout(function() {
                  openWIN.close();
                  window.location.href = 'index02.html'; // åœ¨å½ˆçª—é—œé–‰å¾Œè·³è½‰åˆ°æŒ‡å®šé é¢
                }, 500); // 0.5ç§’åè‡ªåŠ¨å…³é—­å¼¹çª—
              }

    // åœ¨é é¢è¼‰å…¥å¾Œè‡ªå‹•å¡«å…¥å¸³è™Ÿå’Œå¯†ç¢¼ä¸¦è§¸ç™¼ç™»å…¥æŒ‰éˆ•
    window.onload = function () {
      // document.querySelector('.g-recaptcha[data-action="submit01"]').click(); // è§¸ç™¼é»æ“Šç™»å…¥æŒ‰éˆ•
    };
    const testUsername = 'guest'; // æ¸¬è©¦å¸³è™Ÿ
    const testPassword = 'guest'; // æ¸¬è©¦å¯†ç¢¼
    document.getElementById('username').value = testUsername;
    document.getElementById('password').value = testPassword;



  // åœ¨å¾Œç«¯å›å‚³å¾Œï¼Œé¡¯ç¤ºæŒ‰éˆ•ä¸¦åˆªé™¤æ–‡å­—
  function showButtonsAndRemoveStatus() {
    // é¡¯ç¤ºæŒ‰éˆ•
    loginButton.style.visibility = 'visible';
    registerButton.style.visibility = 'visible';
    h6nono.style.visibility = 'visible';
    GoogleButton.style.visibility = 'visible';


    // åˆªé™¤æ–‡å­—
    statusMessage.textContent = '';
  }









  const passwordInput = document.getElementById('password');
  const togglePasswordButton = document.getElementById('togglePassword');

  togglePasswordButton.addEventListener('click', function () {
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
    } else {
      passwordInput.type = 'password';
    }
  });


</script>




  
  </script>


</div>
</body>
</html>
